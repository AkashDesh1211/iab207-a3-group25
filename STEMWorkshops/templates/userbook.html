{% extends 'base.html' %}
{% from "bootstrap5/form.html" import render_form %}

{% block header %}
    
{% endblock %}


{% block content %}
<div class="page-header ms-2 mt-2">
    <h4>{{heading}}</h4>
    <h5>Ticket Price: {{event.ticket_price}}</h5>
</div>

<!-- Form rendering easy using bootstrap and WTF-Forms -->
<div class="col-md-6 ms-2">
    {{render_form(form)}}
</div>

<!-- Total Price Output with Label -->
<div class="mt-3">
  <label for="total-amount" class="form-label">Total Amount</label>
  <p id="total-amount" class="form-control fw-bold text-success" style="background-color: #f5f5f5;">$0.00</p>
</div>


<!--  When login form is shown, show a link for user to register -->
{% if heading == 'Login' %}
<div class="col-md-4 ms-2">
    <p>New user? <a href="{{url_for('auth.register')}}">Click here</a> to register.</p>
</div>
{% endif %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const ticketInput = document.getElementById("ticket_quantity");
    const totalDisplay = document.getElementById("total-amount");

    const price = parseFloat("{{ event.ticket_price | default('0.00', true) }}");

    if (ticketInput && totalDisplay && !isNaN(price)) {
      ticketInput.addEventListener("input", function () {
        const qty = parseInt(this.value);
        if (!isNaN(qty) && qty > 0) {
          const total = qty * price;
          totalDisplay.innerText = total === 0 ? "FREE" : "$" + total.toFixed(2);
        } else {
          totalDisplay.innerText = "$0.00";
        }
      });
    }
  });
</script>
{% endblock %}